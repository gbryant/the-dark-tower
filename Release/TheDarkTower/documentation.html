<HTML><HEAD>   <TITLE>The Dark Tower PB17 Documentation</TITLE><META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=macintosh"></HEAD><BODY BGCOLOR="#666699"><CENTER><FONT SIZE="+3"><B>The Dark TowerDocumentaion</B></FONT><FONT SIZE="+2"><B><BR><BR><BR><BR></B></FONT><A HREF="#specialdirectives"><FONT SIZE="+1"><B>SpecialDirectives</B></FONT></A><FONT SIZE="+2"><B><BR><BR></B></FONT><A HREF="#keyfile"><FONT SIZE="+1"><B>Keyfile</B></FONT></A><FONT SIZE="+2"><B><BR><BR></B></FONT><A HREF="#relocationopcodes"><FONT SIZE="+1"><B>RelocationOpcodes</B></FONT></A><FONT SIZE="+2"><B><BR><BR></B></FONT><A HREF="#currentlimitations"><FONT SIZE="+1"><B>CurrentLimitations</B></FONT></A><FONT SIZE="+2"><B><BR><BR></B></FONT><A HREF="#furtherinformation"><FONT SIZE="+1"><B>FurtherInformation</B></FONT></A><FONT SIZE="+2"><B><BR><BR></B></FONT><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><FONT SIZE="+2"><B><BR><BR><BR><BR><BR><BR><BR><BR><BR></B></FONT><P><FONT SIZE="+2"><B><A NAME=specialdirectives></A>SpecialDirectives</B></FONT><FONT SIZE="+1"><B><BR></B></FONT></P></CENTER><P><FONT SIZE="+1"><B><BR><BR><BR>@data</B></FONT><BR><BR>Includes the contents of a file as directly to your assembled source.Will pad to four byte alignment.<BR><BR>Example: @data "nonsenseData"<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Define</B></FONT><BR><BR>Defines an assembly macro.<BR><BR>Example Definition:<BR><BR>@Define nothing<BR><BR>{<BR><BR>nop<BR><BR>}<BR><BR>Example Call:<BR><BR>_nothing<BR><BR>Generates the code:<BR><BR>nop<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Export</B></FONT><BR><BR>To export symbols to the code section.<BR><BR>Example:<BR><BR>@Export BranchLinkRegister<BR><BR>blr<BR><BR>The code will export the symbol BranchLinkRegister as pointing to theblr instruction.<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Import</B></FONT><BR><BR>For importing symbols from a library.<BR><BR>Example:<BR><BR>@Import CarbonLib<BR><BR>{<BR><BR>Debugger<BR><BR>}<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@_Import</B></FONT><BR><BR>To import symbols from a library as being weak linked.<BR><BR>Example:<BR><BR>@_Import CarbonLib<BR><BR>{<BR><BR>Debugger<BR><BR>}<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Include</B></FONT><BR><BR>Includes the contents of another file in its place. Statement can benested.<BR><BR>Example:<BR><BR>@Include "glue.asm"<BR><BR>The quoted file will be inserted in place.<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@init</B></FONT><BR><BR>Labels the fragment init point.<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@main</B></FONT><BR><BR>Labels the fragment entry point.<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@SectionD</B></FONT><BR><BR>This is used for defining your own data section.<BR><BR><BR><FONT SIZE="+1"><B>SectionD Elements:</B></FONT><BR><BR><BR><B>+labelxxx</B><BR><BR>This will insert the offset of the specified label.<BR><BR><BR><B>$00000000</B><BR><BR>Defines four bytes of data.<BR><BR><BR><B>@ZeroByte xxx</B><BR><BR>Defines xxx zeroed bytes (must be a multiple of 4.)<BR><BR><BR><B>'cool'</B><BR><BR>Defines four bytes of data.<BR><BR><BR><B>:dataxxx</B><BR><BR>dataxxx will hold the offset to that part of the data section.<BR><BR>Example:<BR><BR>@SectionD<BR><BR>{<BR><BR>#TVectors<BR><BR>+main<BR><BR>$00000000<BR><BR>+MyEventHandler:MyEventHandler<BR><BR>$00000000<BR><BR>#Imports<BR><BR>$00000000:NewEventHandlerUPP<BR><BR>@ZeroByte 60:freespace<BR><BR>}<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@term</B></FONT><BR><BR>Labels the fragment term point.<BR><BR><BR><BR><BR><BR></P><CENTER><A NAME=keyfile></A><FONT SIZE="+2"><B>Keyfile</B></FONT><BR></CENTER><P><BR><BR><BR><FONT SIZE="+1"><B>@Assembly "xxx.asm"</B></FONT><BR><BR>For defining the main source file<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Creator "????"</B></FONT><BR><BR>For specifying the creator of the built project file<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Data "xxx.data"</B></FONT><BR><BR>For defining the data section file (raw uncompressed datasection)<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Data: "xxx.data"</B></FONT><BR><BR>For defining the data section file (raw uncompressed data section)and exporting symbols to the data section<BR><BR>&nbsp;<BR>@Data: "xxx.data"<BR><BR>{<BR><BR>$0 "DataStart"<BR><BR>}<BR><BR>For defining the data section file and exported offsets into thatfile<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Relocation "xxx.reloc"</B></FONT><BR><BR>For defining the relocation instruction file<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Resource "xxx.rsrc"</B></FONT><BR><BR>For defining the resource file<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@SecOff</B></FONT><BR><BR>For defining offsets to main, init, term sections within the datasection. All three must be defined in the key file even if all arenot used.<BR><BR>Example:<BR><BR>&nbsp;<BR>@SecOff<BR><BR>{<BR><BR>$000004F4:main<BR><BR>$00000000:init<BR><BR>$00000000:term<BR><BR>}<BR><BR>#init and term are not used and therefore set to 0.<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Target "xxx.app"</B></FONT><BR><BR>For defining the name of the built project file<BR><BR><BR><BR><BR><FONT SIZE="+1"><B>@Type "APPL"</B></FONT><BR><BR>For specifying the type of the built project file<BR><BR><BR><BR><BR><BR></P><CENTER><A NAME=relocationopcodes></A><FONT SIZE="+2"><B>RelocationOpcodes<U><BR><BR><BR><BR></U></B></FONT></CENTER><P>DDAT RelocBySectDWithSkip<BR><BR><B>RelocRun Group:</B><BR><BR>CODE RelocBySectC<BR>DATA RelocBySectD<BR>DESC RelocTVector12<BR>DSC2 RelocTVector8<BR>VTBL RelocVTable8<BR>SYMR RelocImportRun<BR><BR><B>RelocSmIndex Group:</B><BR><BR>SYMB RelocSmByImport<BR>CDIS RelocSmSetSectC<BR>DTIS RelocSmSetSectD<BR>SECN RelocSmBySection<BR><BR>DELT RelocIncrPosition<BR><BR>RPT RelocSmRepeat<BR><BR>LABS RelocSetPosition<BR><BR>LSYM RelocLgByImport<BR><BR>LRPT RelocLgRepeat<BR><BR><B>RelocLgSetOrBySection Group:</B><BR><BR>LSEC 0 RelocLgBySection<BR>LSEC 1 RelocLgSetSectC<BR>LSEC 2 RelocLgSetSectD<BR><BR><BR><BR><BR></P><CENTER><A NAME=currentlimitations></A><FONT SIZE="+2"><B>CurrentLimitations<U><BR><BR><BR><BR></U></B></FONT></CENTER><P>On assembly one data, loader and code section is assumed.<BR><BR>Disassembly is by first fragment in data fork the cfrg resource isignored<BR><BR>Relocations assume they are dealing with the data section<BR><BR>Only uncompressed data sections are used on assembly<BR><BR>You must supply your own cfrg and SIZE resources<BR><BR><BR></P><CENTER><FONT SIZE="+2"><B><A NAME=furtherinformation></A>FurtherInformation<BR><BR><BR></B></FONT></CENTER><P>for documentation on ppc assembly get this pdf:<BR><BR><A HREF="http://www-3.ibm.com/chips/techlib/techlib.nsf/techdocs/852569B20050FF778525699600719DF2/$file/6xx_pem.pdf">http://www-3.ibm.com/chips/techlib/techlib.nsf/techdocs/852569B20050FF778525699600719DF2/$file/6xx_pem.pdf</A><BR><BR><BR>for information on the ABI (application binary interface) try gettingthese pdfs:<BR><BR><A HREF="http://www-3.ibm.com/chips/techlib/techlib.nsf/techdocs/852569B20050FF7785256996007558C6/$file/cwg.pdf">http://www-3.ibm.com/chips/techlib/techlib.nsf/techdocs/852569B20050FF7785256996007558C6/$file/cwg.pdf<BR></A><BR><A HREF="http://developer.apple.com/techpubs/mac/pdf/MacOS_RT_Architectures.pdf">http://developer.apple.com/techpubs/mac/pdf/MacOS_RT_Architectures.pdf</A><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR></P></BODY></HTML>